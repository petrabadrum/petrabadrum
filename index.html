<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Petrabadrum – Offertapp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --petra-dark: #003c8f;
      --petra-main: #007bff;
      --petra-light: #e2e8f0;
      --bg-body: #eef2f6;
    }
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, system-ui, -webkit-system-font, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-body);
      color: #0f172a;
    }
    header {
      background: linear-gradient(135deg, var(--petra-dark), var(--petra-main));
      color: #ffffff;
      padding: 18px 16px 14px 16px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header .title {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.06em;
    }
    header .subtitle {
      font-size: 13px;
      opacity: 0.95;
      margin-top: 4px;
    }
    .container {
      padding: 12px;
      max-width: 900px;
      margin: 0 auto 40px auto;
    }
    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 14px 16px;
      margin-bottom: 14px;
      box-shadow: 0 2px 6px rgba(15, 23, 42, 0.08);
      border: 1px solid #e2e8f0;
    }
    h2 {
      font-size: 17px;
      margin: 0 0 8px 0;
      color: var(--petra-dark);
      font-weight: 700;
    }
    .section-caption {
      font-size: 11px;
      color: #64748b;
      margin-bottom: 8px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }
    label {
      font-size: 13px;
      flex: 1 1 55%;
      padding-right: 8px;
      font-weight: 600;
      color: #1e293b;
    }
    input[type="text"],
    input[type="number"],
    select {
      flex: 1 1 45%;
      padding: 8px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
    }
    input[type="number"] { -moz-appearance: textfield; }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    textarea {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      resize: vertical;
    }
    input[type="checkbox"] {
      transform: scale(1.1);
      margin-right: 6px;
    }
    .checkbox-row {
      display: flex;
      align-items: center;
      margin-bottom: 6px;
    }
    .checkbox-row label {
      flex: 0 1 auto;
      font-weight: 500;
    }
    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #e0edff;
      color: #1d4ed8;
      font-size: 11px;
      margin-left: 6px;
    }
    .price-box {
      font-size: 20px;
      font-weight: 700;
      color: var(--petra-dark);
      margin-bottom: 4px;
    }
    .price-details {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 8px;
    }
    .small {
      font-size: 11px;
      color: #6b7280;
    }
    .btn {
      width: 100%;
      padding: 11px;
      border-radius: 999px;
      border: none;
      font-size: 15px;
      font-weight: 700;
      margin-top: 8px;
      cursor: pointer;
    }
    .btn-primary {
      background: var(--petra-main);
      color: #ffffff;
    }
    .btn-secondary {
      background: var(--petra-light);
      color: #0f172a;
    }
    .btn-outline {
      background: transparent;
      border: 1px solid var(--petra-main);
      color: var(--petra-main);
    }
    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }
    .btn-row .btn {
      flex: 1 1 calc(50% - 4px);
    }
    .entre-card {
      background: #0f172a;
      color: #e5e7eb;
      border-color: #1f2937;
    }
    .entre-card h2 {
      color: #bfdbfe;
    }
    .entre-card textarea {
      background: #020617;
      color: #e5e7eb;
      border-color: #1f2937;
    }
    @media (max-width: 600px) {
      .row { flex-direction: column; }
      label { margin-bottom: 3px; }
    }
    @media print {
      body { background: #ffffff; }
      header { box-shadow: none; }
      .btn, .btn-row { display: none !important; }
      .card { box-shadow: none; border-color: #cbd5e1; }
    }
  </style>
</head>
<body>
<header>
  <div class="title">PETRA BYGG & RENOVERING AB</div>
  <div class="subtitle">Petrabadrum – Offertunderlag för badrumsrenovering</div>
</header>

<div class="container">

  <div class="card">
    <h2>Kunduppgifter</h2>
    <div class="section-caption">Fylls i inför eller under kundbesök.</div>
    <div class="row">
      <label for="kundnamn">Kundnamn</label>
      <input id="kundnamn" type="text" placeholder="Ex. Anna Andersson">
    </div>
    <div class="row">
      <label for="adress">Adress</label>
      <input id="adress" type="text" placeholder="Gata, postnummer, ort">
    </div>
    <div class="row">
      <label for="telefon">Telefon</label>
      <input id="telefon" type="text">
    </div>
    <div class="row">
      <label for="epost">E-post</label>
      <input id="epost" type="text">
    </div>
  </div>

  <div class="card">
    <h2>Badrumsdata</h2>
    <div class="row">
      <label for="nivå">Standardnivå <span class="pill">Pris per m²</span></label>
      <select id="nivå">
        <option value="standard">Standard</option>
        <option value="premium">Premium</option>
        <option value="exklusiv">Exklusiv</option>
      </select>
    </div>
    <div class="row">
      <label for="storlek">Badrumsstorlek (m²)</label>
      <input id="storlek" type="number" step="0.1" min="0">
    </div>
    <div class="row">
      <label for="takhöjd">Takhöjd (m)</label>
      <input id="takhöjd" type="number" step="0.05" min="0">
    </div>
  </div>

  <div class="card">
    <h2>Ytskikt</h2>
    <div class="row">
      <label for="kakel_vägg">Kakelstorlek vägg</label>
      <input id="kakel_vägg" type="text" placeholder="Ex. 30x60">
    </div>
    <div class="row">
      <label for="fogfärg">Fogfärg</label>
      <input id="fogfärg" type="text">
    </div>
    <div class="row">
      <label for="klinker_golv">Klinker storlek golv</label>
      <input id="klinker_golv" type="text" placeholder="Ex. 10x10">
    </div>
  </div>

  <div class="card">
    <h2>Funktioner & utrustning</h2>

    <div class="checkbox-row">
      <input id="wc_vägg" type="checkbox">
      <label for="wc_vägg">Vägghängd toalett</label>
    </div>
    <div class="checkbox-row">
      <input id="handdusch_wc" type="checkbox">
      <label for="handdusch_wc">Handdusch vid toalett</label>
    </div>
    <div class="checkbox-row">
      <input id="badkar" type="checkbox">
      <label for="badkar">Badkar</label>
    </div>
    <div class="checkbox-row">
      <input id="enbart_dusch" type="checkbox">
      <label for="enbart_dusch">Enbart dusch</label>
    </div>

    <div class="row">
      <label for="nischer">Nischer i väggar (antal)</label>
      <input id="nischer" type="number" min="0" step="1">
    </div>

    <div class="checkbox-row">
      <input id="tvättmaskin" type="checkbox">
      <label for="tvättmaskin">Tvättmaskin inkl el &amp; avlopp</label>
    </div>

    <div class="row">
      <label for="vattenledningar">Vattenledningar</label>
      <select id="vattenledningar">
        <option value="utan">Utanpåliggande</option>
        <option value="infällda">Infällda</option>
      </select>
    </div>

    <div class="row">
      <label for="golvvärme">Golvvärme</label>
      <select id="golvvärme">
        <option value="ingen">Ingen</option>
        <option value="el">El</option>
        <option value="vatten">Vatten</option>
      </select>
    </div>

    <div class="row">
      <label for="handdukstork">Handdukstork</label>
      <select id="handdukstork">
        <option value="ingen">Ingen</option>
        <option value="el">El</option>
        <option value="vatten">Vatten</option>
      </select>
    </div>

    <div class="row">
      <label for="spotlights">El, antal spotlights</label>
      <input id="spotlights" type="number" min="0" step="1">
    </div>

    <div class="checkbox-row">
      <input id="undertak" type="checkbox">
      <label for="undertak">Undertak/sänkt tak</label>
    </div>

    <div class="checkbox-row">
      <input id="behålla_dörr" type="checkbox" checked>
      <label for="behålla_dörr">Behålla befintlig dörr &amp; tröskel</label>
    </div>

    <div class="row">
      <label for="golvavlopp">Golvavlopp</label>
      <select id="golvavlopp">
        <option value="trad">Traditionellt</option>
        <option value="unidrain">Unidrain</option>
      </select>
    </div>

    <div class="row" style="margin-top:6px;">
      <label for="badrumsinredning">Badrumsinredning (beskrivning)</label>
    </div>
    <textarea id="badrumsinredning" rows="2" placeholder="Kommod, spegelskåp, högskåp, blandare..."></textarea>

    <div class="row" style="margin-top:6px;">
      <label for="glas">Glaslösning (dörrar/vägg)</label>
    </div>
    <textarea id="glas" rows="2" placeholder="Glasvägg, vikdörrar, duschhörna..."></textarea>
  </div>

  <div class="card">
    <h2>Preliminärt pris & offertunderlag</h2>
    <p class="small">
      Prisnivåer nedan är exempel (exkl. riv, tilläggsarbete m.m.). Anpassa efter Petra Byggs kalkyl innan skarp användning.
    </p>

    <div id="pris_text" class="price-box">–</div>
    <div id="pris_detaljer" class="price-details"></div>

    <div class="btn-row">
      <button class="btn btn-primary" onclick="beräknaPris()">Beräkna pris</button>
      <button class="btn btn-secondary" onclick="kopieraSammanfattning()">Kopiera sammanfattning</button>
    </div>
    <div class="btn-row">
      <button class="btn btn-secondary" onclick="skapaPDF()">Skapa PDF (skriv ut)</button>
      <button class="btn btn-outline" onclick="skickaMail()">Maila offertunderlag</button>
    </div>

    <textarea id="sammanfattning" rows="9" style="margin-top:8px;" placeholder="Här visas sammanfattningen till kund/offertsystem..."></textarea>
  </div>

  <div class="card entre-card">
    <h2>Entreprenörsvy – PETRA HUS AB</h2>
    <p class="small">
      Denna vy kan kopieras och skickas till Petra Hus eller användas som underlag vid inmatning i deras offertsystem.
    </p>
    <textarea id="entre_sammanfattning" rows="11" placeholder="Beräkna pris först, så fylls entreprenörsvyn i automatiskt."></textarea>
  </div>

</div>

<script>
  // PRISER – EXEMPEL, EXKL MOMS. Justera efter prisfilen.
  const priser = {
    BASE_STD_M2: 10000,   // Basrenovering Standard per m²
    BASE_PREM_M2: 13000,  // Basrenovering Premium per m²
    BASE_EXKL_M2: 16000,  // Basrenovering Exklusiv per m²

    WC_VÄGG:      12000,  // Vägghängd toalett inkl fixtur
    GOLVV_EL_M2:  1500,   // Golvvärme el per m²
    GOLVV_VAT_M2: 2000,   // Golvvärme vatten per m²
    UNIDRAIN:     8000,   // Unidrain golvavlopp
    NISCH:        3500,   // Platsbyggd kaklad nisch per st
    TVÄTT:        6000,   // Tvättmaskin inkl el & avlopp
    GLAS:         9000,   // Glaslösning dusch
    HANDDUK_EL:   4000,   // Handdukstork el
    HANDDUK_VAT:  5000,   // Handdukstork vatten
    SPOT:         900,    // Spotlight per st
    UNDERTAK:     6000    // Undertak/sänkt tak
  };

  function formatCurrency(value) {
    if (isNaN(value)) return "-";
    return value.toLocaleString("sv-SE", {
      style: "currency",
      currency: "SEK",
      maximumFractionDigits: 0
    });
  }

  function beräknaPris() {
    const m2         = parseFloat(document.getElementById("storlek").value) || 0;
    const wcVägg     = document.getElementById("wc_vägg").checked;
    const golvvärme  = document.getElementById("golvvärme").value;
    const nischer    = parseInt(document.getElementById("nischer").value) || 0;
    const tvätt      = document.getElementById("tvättmaskin").checked;
    const glasText   = document.getElementById("glas").value.trim();
    const golvavlopp = document.getElementById("golvavlopp").value;
    const handduk    = document.getElementById("handdukstork").value;
    const spots      = parseInt(document.getElementById("spotlights").value) || 0;
    const undertak   = document.getElementById("undertak").checked;
    const nivå       = document.getElementById("nivå").value;

    let sumEx = 0;
    let rader = [];

    // Bas baserat på nivå
    if (m2 > 0) {
      let kod;
      if (nivå === "standard")  kod = "BASE_STD_M2";
      if (nivå === "premium")   kod = "BASE_PREM_M2";
      if (nivå === "exklusiv")  kod = "BASE_EXKL_M2";

      const ápris = priser[kod];
      const belopp = m2 * ápris;
      sumEx += belopp;
      const nivåText = nivå.charAt(0).toUpperCase() + nivå.slice(1);
      rader.push("Basrenovering " + nivåText + " " + m2.toFixed(1) + " m²: " + formatCurrency(belopp));
    }

    // Vägghängd WC
    if (wcVägg) {
      sumEx += priser.WC_VÄGG;
      rader.push("Vägghängd WC: " + formatCurrency(priser.WC_VÄGG));
    }

    // Golvvärme
    if (golvvärme === "el" && m2 > 0) {
      const belopp = m2 * priser.GOLVV_EL_M2;
      sumEx += belopp;
      rader.push("Golvvärme (el) " + m2.toFixed(1) + " m²: " + formatCurrency(belopp));
    } else if (golvvärme === "vatten" && m2 > 0) {
      const belopp = m2 * priser.GOLVV_VAT_M2;
      sumEx += belopp;
      rader.push("Golvvärme (vatten) " + m2.toFixed(1) + " m²: " + formatCurrency(belopp));
    }

    // Unidrain
    if (golvavlopp === "unidrain") {
      sumEx += priser.UNIDRAIN;
      rader.push("Unidrain golvavlopp: " + formatCurrency(priser.UNIDRAIN));
    }

    // Nischer
    if (nischer > 0) {
      const belopp = nischer * priser.NISCH;
      sumEx += belopp;
      rader.push("Nischer " + nischer + " st: " + formatCurrency(belopp));
    }

    // Tvättmaskin
    if (tvätt) {
      sumEx += priser.TVÄTT;
      rader.push("Förberedelse tvättmaskin (el & avlopp): " + formatCurrency(priser.TVÄTT));
    }

    // Glas
    if (glasText.length > 0) {
      sumEx += priser.GLAS;
      rader.push("Glaslösning dusch: " + formatCurrency(priser.GLAS));
    }

    // Handdukstork
    if (handduk === "el") {
      sumEx += priser.HANDDUK_EL;
      rader.push("Handdukstork (el): " + formatCurrency(priser.HANDDUK_EL));
    } else if (handduk === "vatten") {
      sumEx += priser.HANDDUK_VAT;
      rader.push("Handdukstork (vatten): " + formatCurrency(priser.HANDDUK_VAT));
    }

    // Spotlights
    if (spots > 0) {
      const belopp = spots * priser.SPOT;
      sumEx += belopp;
      rader.push("Spotlights " + spots + " st: " + formatCurrency(belopp));
    }

    // Undertak
    if (undertak) {
      sumEx += priser.UNDERTAK;
      rader.push("Undertak/sänkt tak: " + formatCurrency(priser.UNDERTAK));
    }

    const sumInkl = sumEx * 1.25;

    if (sumEx > 0) {
      document.getElementById("pris_text").innerText =
        formatCurrency(sumInkl) + " inkl moms (preliminärt)";
      document.getElementById("pris_detaljer").innerText =
        "Exkl moms: " + formatCurrency(sumEx) +
        " • Moms 25%: " + formatCurrency(sumInkl - sumEx);
    } else {
      document.getElementById("pris_text").innerText = "–";
      document.getElementById("pris_detaljer").innerText = "";
    }

    byggSammanfattning(sumInkl, sumEx, rader);
  }

  function byggSammanfattning(sumInkl, sumEx, prisrader) {
    const kund = document.getElementById("kundnamn").value;
    const adress = document.getElementById("adress").value;
    const tel = document.getElementById("telefon").value;
    const epost = document.getElementById("epost").value;

    const nivå = document.getElementById("nivå").value;
    const m2 = document.getElementById("storlek").value;
    const tak = document.getElementById("takhöjd").value;
    const kakel = document.getElementById("kakel_vägg").value;
    const fog = document.getElementById("fogfärg").value;
    const klinker = document.getElementById("klinker_golv").value;

    const wcVägg = document.getElementById("wc_vägg").checked ? "Ja" : "Nej";
    const handdusch = document.getElementById("handdusch_wc").checked ? "Ja" : "Nej";
    const badkar = document.getElementById("badkar").checked ? "Ja" : "Nej";
    const enbartDusch = document.getElementById("enbart_dusch").checked ? "Ja" : "Nej";
    const nischer = document.getElementById("nischer").value || "0";
    const tvätt = document.getElementById("tvättmaskin").checked ? "Ja" : "Nej";
    const vattenledningar = document.getElementById("vattenledningar").value;
    const golvvärme = document.getElementById("golvvärme").value;
    const handduk = document.getElementById("handdukstork").value;
    const spots = document.getElementById("spotlights").value || "0";
    const undertak = document.getElementById("undertak").checked ? "Ja" : "Nej";
    const behållaDörr = document.getElementById("behålla_dörr").checked ? "Ja" : "Nej";
    const golvavlopp = document.getElementById("golvavlopp").value === "unidrain" ? "Unidrain" : "Traditionellt";
    const inredning = document.getElementById("badrumsinredning").value;
    const glas = document.getElementById("glas").value;

    let nivåText = nivå.charAt(0).toUpperCase() + nivå.slice(1);

    // Kundvy
    let text = "";
    text += "Kund: " + (kund || "-") + "\n";
    text += "Adress: " + (adress || "-") + "\n";
    if (tel) text += "Telefon: " + tel + "\n";
    if (epost) text += "E-post: " + epost + "\n";
    text += "\n";

    text += "Standardnivå: " + nivåText + "\n";
    text += "Badrum ca " + (m2 || "?") + " m², takhöjd " + (tak || "?") + " m.\n";
    text += "Ytskikt: väggkakel " + (kakel || "?") + ", fogfärg " + (fog || "?") +
            ", klinker golv " + (klinker || "?") + ".\n\n";

    text += "Funktioner och utrustning:\n";
    text += "- Vägghängd WC: " + wcVägg + "\n";
    text += "- Handdusch vid toalett: " + handdusch + "\n";
    text += "- Badkar: " + badkar + "\n";
    text += "- Enbart dusch: " + enbartDusch + "\n";
    text += "- Nischer i väggar: " + nischer + " st\n";
    text += "- Tvättmaskin inkl el & avlopp: " + tvätt + "\n";
    text += "- Vattenledningar: " + vattenledningar + "\n";
    text += "- Golvvärme: " + golvvärme + "\n";
    text += "- Handdukstork: " + handduk + "\n";
    text += "- Antal spotlights: " + spots + "\n";
    text += "- Undertak/sänkt tak: " + undertak + "\n";
    text += "- Behålla befintlig dörr & tröskel: " + behållaDörr + "\n";
    text += "- Golvavlopp: " + golvavlopp + "\n";
    text += "- Badrumsinredning: " + (inredning || "-") + "\n";
    text += "- Glaslösning: " + (glas || "-") + "\n\n";

    if (prisrader && prisrader.length > 0) {
      text += "Prisuppdelning (preliminär, exkl moms):\n";
      prisrader.forEach(rad => text += "- " + rad + "\n");
      text += "\n";
    }

    if (!isNaN(sumInkl) && sumInkl > 0) {
      text += "Preliminärt totalpris (exkl moms): " + formatCurrency(sumEx) + "\n";
      text += "Preliminärt totalpris (inkl moms): " + formatCurrency(sumInkl) + ".\n";
      text += "Observera att detta är ett ungefärligt pris baserat på standardutförande. Slutlig offert lämnas efter genomgång av alla detaljer.\n\n";
    } else {
      text += "Preliminärt pris har inte beräknats ännu.\n\n";
    }

    // Entreprenörens ansvar – alltid fullt block
    const entreprenörAnsvar =
      "Entreprenörens ansvar:\n" +
      "- Rivning av befintligt badrum\n" +
      "- Eventuell flytt av rör/nya rör\n" +
      "- Eventuell uppriktning av väggar\n" +
      "- Eventuell montering av nytt undergolv\n" +
      "- Inköp av rörmaterial\n" +
      "- Inköp av elmaterial\n" +
      "- Eventuellt inköp av undergolv (spånskivor)\n" +
      "- Eventuellt inköp av gipsskivor till tak\n" +
      "- Inköp av flytspackel\n" +
      "- Inköp av tätskikt\n" +
      "- Inköp av kakellim\n" +
      "- Inköp av kakelfog\n" +
      "- Inköp av mjukfog\n" +
      "- Eventuell montering av golvvärme\n" +
      "- Eventuellt inköp av material till golvvärme\n" +
      "- Flytspackling\n" +
      "- Eventuell frakt av plattor och inredning\n" +
      "- Eventuell montering av nischer\n" +
      "- Eldragning\n" +
      "- Eventuell montering av spotlights\n" +
      "- Montering av tätskikt\n" +
      "- Montering av golvbrunnar\n" +
      "- Montering av plattor\n" +
      "- Eventuell spackling i tak\n" +
      "- Eventuellt inköp av våtrumsspackel\n" +
      "- Eventuell målning i tak\n" +
      "- Eventuellt inköp av våtrumsfärg\n" +
      "- Fogning av plattor\n" +
      "- Deponi\n" +
      "- Montering av all badrumsinredning\n" +
      "- Eventuellt inköp av dörrtröskel\n" +
      "- Eventuell montering av dörrtröskel\n" +
      "- Grovstädning\n\n";

    const kundAnsvar =
      "Kundens ansvar:\n" +
      "- Köp av kakel/klinker (vi kan ombesörja frakten)\n" +
      "- Köp av all badrumsinredning (vi kan ombesörja frakten)\n";

    text += entreprenörAnsvar + kundAnsvar;

    document.getElementById("sammanfattning").value = text;

    // Entreprenörsvy
    let entre = "";
    entre += "PETRA HUS AB – UNDERLAG FÖR OFFERT\n";
    entre += "====================================\n\n";
    entre += "Kund: " + (kund || "-") + "\n";
    entre += "Adress: " + (adress || "-") + "\n";
    if (tel) entre += "Telefon: " + tel + "\n";
    if (epost) entre += "E-post: " + epost + "\n";
    entre += "\n";

    entre += "Standardnivå: " + nivåText + "\n";
    entre += "Yta: " + (m2 || "?") + " m² • Takhöjd: " + (tak || "?") + " m\n";
    entre += "Golvavlopp: " + golvavlopp + "\n";
    entre += "Vattenledningar: " + vattenledningar + "\n";
    entre += "Golvvärme: " + golvvärme + "\n";
    entre += "Handdukstork: " + handduk + "\n";
    entre += "Spotlights: " + spots + " st • Undertak: " + undertak + "\n";
    entre += "Nischer: " + nischer + " st\n";
    entre += "WC vägghängd: " + wcVägg + " • Handdusch WC: " + handdusch + "\n";
    entre += "Badkar: " + badkar + " • Enbart dusch: " + enbartDusch + "\n\n";

    entre += "Ytskikt:\n";
    entre += "- Kakel vägg: " + (kakel || "-") + "\n";
    entre += "- Fogfärg: " + (fog || "-") + "\n";
    entre += "- Klinker golv: " + (klinker || "-") + "\n\n";

    entre += "Inredning:\n";
    entre += "- Badrumsinredning: " + (inredning || "-") + "\n";
    entre += "- Glaslösning: " + (glas || "-") + "\n\n";

    if (prisrader && prisrader.length > 0) {
      entre += "Prisuppdelning (preliminär, exkl moms):\n";
      prisrader.forEach(rad => entre += "- " + rad + "\n");
      entre += "\n";
    }

    if (!isNaN(sumInkl) && sumInkl > 0) {
      entre += "Preliminärt totalpris exkl moms: " + formatCurrency(sumEx) + "\n";
      entre += "Preliminärt totalpris inkl moms: " + formatCurrency(sumInkl) + "\n\n";
    } else {
      entre += "Preliminärt pris ej beräknat.\n\n";
    }

    entre += entreprenörAnsvar + kundAnsvar;
    entre += "\nNotering: Detta är ett underlag. Petra Hus AB justerar vid behov enligt egen kalkyl.";

    document.getElementById("entre_sammanfattning").value = entre;
  }

  function kopieraSammanfattning() {
    const textarea = document.getElementById("sammanfattning");
    if (!textarea.value) {
      beräknaPris();
    }
    textarea.select();
    textarea.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("Sammanfattning kopierad. Klistra in i sms, mail eller offertsystem.");
  }

  function skapaPDF() {
    if (!document.getElementById("sammanfattning").value) {
      beräknaPris();
    }
    window.print();
  }

  function skickaMail() {
    const kund = document.getElementById("kundnamn").value || "";
    if (!document.getElementById("sammanfattning").value) {
      beräknaPris();
    }
    const body = encodeURIComponent(document.getElementById("sammanfattning").value);
    const subject = encodeURIComponent("Offertunderlag badrumsrenovering – " + kund);
    window.location.href = "mailto:?subject=" + subject + "&body=" + body;
  }
</script>
</body>
</html>
